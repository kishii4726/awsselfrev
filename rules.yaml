rules:
  s3-encryption:
    service: S3
    level: Alert
    issue: Bucket encryption is not set
  s3-public-access:
    service: S3
    level: Alert
    issue: Block public access is all off
  s3-lifecycle:
    service: S3
    level: Warning
    issue: Lifecycle policy is not set
  s3-object-lock:
    service: S3
    level: Warning
    issue: Object Lock is not enabled
  s3-sse-kms-encryption:
    service: S3
    level: Warning
    issue: SSE-KMS encryption is not set
  s3-server-access-logging:
    service: S3
    level: Warning
    issue: Server access logging is not enabled
  ec2-ebs-default-encryption:
    service: EC2
    level: Warning
    issue: Default encryption for EBS is not set
  ec2-volume-encryption:
    service: EC2
    level: Alert
    issue: EBS encryption is not set
  ec2-snapshot-encryption:
    service: EC2
    level: Alert
    issue: EBS encryption is not set
  rds-storage-encryption:
    service: RDS
    level: Alert
    issue: Storage encryption is not set
  rds-deletion-protection:
    service: RDS
    level: Warning
    issue: Delete protection is not enabled
  rds-log-export:
    service: RDS
    level: Warning
    issue: Log export is not set
  rds-auto-minor-version-upgrade:
    service: RDS
    level: Warning
    issue: Auto minor version upgrade is enabled
  rds-backup-enabled:
    service: RDS
    level: Warning
    issue: Backup is not enabled
  rds-default-parameter-group:
    service: RDS
    level: Warning
    issue: Default parameter group is used
  vpc-name-tag:
    service: VPC
    level: Info
    issue: Name tag is not set
  vpc-dns-hostname:
    service: VPC
    level: Warning
    issue: DNS hostname is not enabled
  vpc-dns-support:
    service: VPC
    level: Warning
    issue: DNS support is not enabled
  vpc-flow-logs:
    service: VPC
    level: Warning
    issue: VPC flow logs is not enabled
  cloudwatch-retention:
    service: CloudWatchLogs
    level: Alert
    issue: Retention is set to never expire
  cloudwatch-log-group-encryption:
    service: CloudWatchLogs
    level: Warning
    issue: Log group is not encrypted with KMS
  ecr-tag-immutability:
    service: ECR
    level: Warning
    issue: Tags can be overwritten
  ecr-image-scanning:
    service: ECR
    level: Warning
    issue: Image scanning is not enabled
  ecr-lifecycle-policy:
    service: ECR
    level: Info
    issue: Lifecycle policy is not set
  vpc-flow-logs-custom-format:
    service: VPC
    level: Info
    issue: Custom flow log format is not set or missing required fields
  route53-query-logging:
    service: Route53
    level: Warning
    issue: Query logging is not enabled
  alb-access-logging:
    service: ELB
    level: Warning
    issue: Access logs are not enabled
  alb-connection-logging:
    service: ELB
    level: Warning
    issue: Connection logs are not enabled
  alb-deletion-protection:
    service: ELB
    level: Warning
    issue: Deletion protection is not enabled
  ecs-container-insights:
    service: ECS
    level: Warning
    issue: Container Insights is not enabled
  ecs-service-circuit-breaker:
    service: ECS
    level: Warning
    issue: Circuit breaker is not enabled
  ecs-cpu-architecture:
    service: ECS
    level: Warning
    issue: ARM64 architecture is not used
  ecs-propagate-tags:
    service: ECS
    level: Warning
    issue: Propagate tags is not set
